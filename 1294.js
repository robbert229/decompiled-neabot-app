var t, o;
t = this;

o = function (t) {
  (function () {
    var o = t,
      f = o.lib.StreamCipher,
      s = [],
      c = [],
      n = [],
      h = (o.algo.Rabbit = f.extend({
        _doReset: function () {
          for (var t = this._key.words, o = this.cfg.iv, f = 0; f < 4; f++) t[f] = (16711935 & ((t[f] << 8) | (t[f] >>> 24))) | (4278255360 & ((t[f] << 24) | (t[f] >>> 8)));

          var s = (this._X = [t[0], (t[3] << 16) | (t[2] >>> 16), t[1], (t[0] << 16) | (t[3] >>> 16), t[2], (t[1] << 16) | (t[0] >>> 16), t[3], (t[2] << 16) | (t[1] >>> 16)]),
            c = (this._C = [
              (t[2] << 16) | (t[2] >>> 16),
              (4294901760 & t[0]) | (65535 & t[1]),
              (t[3] << 16) | (t[3] >>> 16),
              (4294901760 & t[1]) | (65535 & t[2]),
              (t[0] << 16) | (t[0] >>> 16),
              (4294901760 & t[2]) | (65535 & t[3]),
              (t[1] << 16) | (t[1] >>> 16),
              (4294901760 & t[3]) | (65535 & t[0]),
            ]);
          this._b = 0;

          for (f = 0; f < 4; f++) _.call(this);

          for (f = 0; f < 8; f++) c[f] ^= s[(f + 4) & 7];

          if (o) {
            var n = o.words,
              h = n[0],
              b = n[1],
              v = (16711935 & ((h << 8) | (h >>> 24))) | (4278255360 & ((h << 24) | (h >>> 8))),
              l = (16711935 & ((b << 8) | (b >>> 24))) | (4278255360 & ((b << 24) | (b >>> 8))),
              p = (v >>> 16) | (4294901760 & l),
              u = (l << 16) | (65535 & v);
            c[0] ^= v;
            c[1] ^= p;
            c[2] ^= l;
            c[3] ^= u;
            c[4] ^= v;
            c[5] ^= p;
            c[6] ^= l;
            c[7] ^= u;

            for (f = 0; f < 4; f++) _.call(this);
          }
        },
        _doProcessBlock: function (t, o) {
          var f = this._X;

          _.call(this);

          s[0] = f[0] ^ (f[5] >>> 16) ^ (f[3] << 16);
          s[1] = f[2] ^ (f[7] >>> 16) ^ (f[5] << 16);
          s[2] = f[4] ^ (f[1] >>> 16) ^ (f[7] << 16);
          s[3] = f[6] ^ (f[3] >>> 16) ^ (f[1] << 16);

          for (var c = 0; c < 4; c++) {
            s[c] = (16711935 & ((s[c] << 8) | (s[c] >>> 24))) | (4278255360 & ((s[c] << 24) | (s[c] >>> 8)));
            t[o + c] ^= s[c];
          }
        },
        blockSize: 4,
        ivSize: 2,
      }));

    function _() {
      for (var t = this._X, o = this._C, f = 0; f < 8; f++) c[f] = o[f];

      o[0] = (o[0] + 1295307597 + this._b) | 0;
      o[1] = (o[1] + 3545052371 + (o[0] >>> 0 < c[0] >>> 0 ? 1 : 0)) | 0;
      o[2] = (o[2] + 886263092 + (o[1] >>> 0 < c[1] >>> 0 ? 1 : 0)) | 0;
      o[3] = (o[3] + 1295307597 + (o[2] >>> 0 < c[2] >>> 0 ? 1 : 0)) | 0;
      o[4] = (o[4] + 3545052371 + (o[3] >>> 0 < c[3] >>> 0 ? 1 : 0)) | 0;
      o[5] = (o[5] + 886263092 + (o[4] >>> 0 < c[4] >>> 0 ? 1 : 0)) | 0;
      o[6] = (o[6] + 1295307597 + (o[5] >>> 0 < c[5] >>> 0 ? 1 : 0)) | 0;
      o[7] = (o[7] + 3545052371 + (o[6] >>> 0 < c[6] >>> 0 ? 1 : 0)) | 0;
      this._b = o[7] >>> 0 < c[7] >>> 0 ? 1 : 0;

      for (f = 0; f < 8; f++) {
        var s = t[f] + o[f],
          h = 65535 & s,
          _ = s >>> 16,
          b = ((((h * h) >>> 17) + h * _) >>> 15) + _ * _,
          v = (((4294901760 & s) * s) | 0) + (((65535 & s) * s) | 0);

        n[f] = b ^ v;
      }

      t[0] = (n[0] + ((n[7] << 16) | (n[7] >>> 16)) + ((n[6] << 16) | (n[6] >>> 16))) | 0;
      t[1] = (n[1] + ((n[0] << 8) | (n[0] >>> 24)) + n[7]) | 0;
      t[2] = (n[2] + ((n[1] << 16) | (n[1] >>> 16)) + ((n[0] << 16) | (n[0] >>> 16))) | 0;
      t[3] = (n[3] + ((n[2] << 8) | (n[2] >>> 24)) + n[1]) | 0;
      t[4] = (n[4] + ((n[3] << 16) | (n[3] >>> 16)) + ((n[2] << 16) | (n[2] >>> 16))) | 0;
      t[5] = (n[5] + ((n[4] << 8) | (n[4] >>> 24)) + n[3]) | 0;
      t[6] = (n[6] + ((n[5] << 16) | (n[5] >>> 16)) + ((n[4] << 16) | (n[4] >>> 16))) | 0;
      t[7] = (n[7] + ((n[6] << 8) | (n[6] >>> 24)) + n[5]) | 0;
    }

    o.Rabbit = f._createHelper(h);
  })();

  return t.Rabbit;
};

if ('object' == typeof exports) module.exports = exports = o(require('crypto-js'), require('./1266'), require('./1268'), require('./1278'), require('./1279'));
else if ('function' == typeof define && define.amd) define(['./core', './enc-base64', './md5', './evpkdf', './cipher-core'], o);
else o(t.CryptoJS);
