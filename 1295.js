var t, o;
t = this;

o = function (t) {
  (function () {
    var o = t,
      c = o.lib.StreamCipher,
      f = [],
      s = [],
      n = [],
      h = (o.algo.RabbitLegacy = c.extend({
        _doReset: function () {
          var t = this._key.words,
            o = this.cfg.iv,
            c = (this._X = [t[0], (t[3] << 16) | (t[2] >>> 16), t[1], (t[0] << 16) | (t[3] >>> 16), t[2], (t[1] << 16) | (t[0] >>> 16), t[3], (t[2] << 16) | (t[1] >>> 16)]),
            f = (this._C = [
              (t[2] << 16) | (t[2] >>> 16),
              (4294901760 & t[0]) | (65535 & t[1]),
              (t[3] << 16) | (t[3] >>> 16),
              (4294901760 & t[1]) | (65535 & t[2]),
              (t[0] << 16) | (t[0] >>> 16),
              (4294901760 & t[2]) | (65535 & t[3]),
              (t[1] << 16) | (t[1] >>> 16),
              (4294901760 & t[3]) | (65535 & t[0]),
            ]);
          this._b = 0;

          for (var s = 0; s < 4; s++) _.call(this);

          for (s = 0; s < 8; s++) f[s] ^= c[(s + 4) & 7];

          if (o) {
            var n = o.words,
              h = n[0],
              b = n[1],
              v = (16711935 & ((h << 8) | (h >>> 24))) | (4278255360 & ((h << 24) | (h >>> 8))),
              l = (16711935 & ((b << 8) | (b >>> 24))) | (4278255360 & ((b << 24) | (b >>> 8))),
              p = (v >>> 16) | (4294901760 & l),
              u = (l << 16) | (65535 & v);
            f[0] ^= v;
            f[1] ^= p;
            f[2] ^= l;
            f[3] ^= u;
            f[4] ^= v;
            f[5] ^= p;
            f[6] ^= l;
            f[7] ^= u;

            for (s = 0; s < 4; s++) _.call(this);
          }
        },
        _doProcessBlock: function (t, o) {
          var c = this._X;

          _.call(this);

          f[0] = c[0] ^ (c[5] >>> 16) ^ (c[3] << 16);
          f[1] = c[2] ^ (c[7] >>> 16) ^ (c[5] << 16);
          f[2] = c[4] ^ (c[1] >>> 16) ^ (c[7] << 16);
          f[3] = c[6] ^ (c[3] >>> 16) ^ (c[1] << 16);

          for (var s = 0; s < 4; s++) {
            f[s] = (16711935 & ((f[s] << 8) | (f[s] >>> 24))) | (4278255360 & ((f[s] << 24) | (f[s] >>> 8)));
            t[o + s] ^= f[s];
          }
        },
        blockSize: 4,
        ivSize: 2,
      }));

    function _() {
      for (var t = this._X, o = this._C, c = 0; c < 8; c++) s[c] = o[c];

      o[0] = (o[0] + 1295307597 + this._b) | 0;
      o[1] = (o[1] + 3545052371 + (o[0] >>> 0 < s[0] >>> 0 ? 1 : 0)) | 0;
      o[2] = (o[2] + 886263092 + (o[1] >>> 0 < s[1] >>> 0 ? 1 : 0)) | 0;
      o[3] = (o[3] + 1295307597 + (o[2] >>> 0 < s[2] >>> 0 ? 1 : 0)) | 0;
      o[4] = (o[4] + 3545052371 + (o[3] >>> 0 < s[3] >>> 0 ? 1 : 0)) | 0;
      o[5] = (o[5] + 886263092 + (o[4] >>> 0 < s[4] >>> 0 ? 1 : 0)) | 0;
      o[6] = (o[6] + 1295307597 + (o[5] >>> 0 < s[5] >>> 0 ? 1 : 0)) | 0;
      o[7] = (o[7] + 3545052371 + (o[6] >>> 0 < s[6] >>> 0 ? 1 : 0)) | 0;
      this._b = o[7] >>> 0 < s[7] >>> 0 ? 1 : 0;

      for (c = 0; c < 8; c++) {
        var f = t[c] + o[c],
          h = 65535 & f,
          _ = f >>> 16,
          b = ((((h * h) >>> 17) + h * _) >>> 15) + _ * _,
          v = (((4294901760 & f) * f) | 0) + (((65535 & f) * f) | 0);

        n[c] = b ^ v;
      }

      t[0] = (n[0] + ((n[7] << 16) | (n[7] >>> 16)) + ((n[6] << 16) | (n[6] >>> 16))) | 0;
      t[1] = (n[1] + ((n[0] << 8) | (n[0] >>> 24)) + n[7]) | 0;
      t[2] = (n[2] + ((n[1] << 16) | (n[1] >>> 16)) + ((n[0] << 16) | (n[0] >>> 16))) | 0;
      t[3] = (n[3] + ((n[2] << 8) | (n[2] >>> 24)) + n[1]) | 0;
      t[4] = (n[4] + ((n[3] << 16) | (n[3] >>> 16)) + ((n[2] << 16) | (n[2] >>> 16))) | 0;
      t[5] = (n[5] + ((n[4] << 8) | (n[4] >>> 24)) + n[3]) | 0;
      t[6] = (n[6] + ((n[5] << 16) | (n[5] >>> 16)) + ((n[4] << 16) | (n[4] >>> 16))) | 0;
      t[7] = (n[7] + ((n[6] << 8) | (n[6] >>> 24)) + n[5]) | 0;
    }

    o.RabbitLegacy = c._createHelper(h);
  })();

  return t.RabbitLegacy;
};

if ('object' == typeof exports) module.exports = exports = o(require('crypto-js'), require('./1266'), require('./1268'), require('./1278'), require('./1279'));
else if ('function' == typeof define && define.amd) define(['./core', './enc-base64', './md5', './evpkdf', './cipher-core'], o);
else o(t.CryptoJS);
